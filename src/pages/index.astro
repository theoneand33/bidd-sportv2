---
const cssHref = import.meta.env.PROD ? '/styles.css' : null;
if (!import.meta.env.PROD) {
  // In development, import the local Tailwind-processed CSS so HMR works.
  await import('../styles/global.css');
}

// Import presentational components
import Header from '../components/Header.astro';
import MeetsView from '../components/MeetsView.astro';
import EventsView from '../components/EventsView.astro';
import ResultsView from '../components/ResultsView.astro';
import SignupView from '../components/SignupView.astro';
import Modals from '../components/Modals.astro';
---
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bidd Sports</title>

  <!-- Link to the Web App Manifest -->
  <link rel="manifest" href="manifest.json" />
  <!-- Theme color for the browser address bar -->
  <meta name="theme-color" content="#4f46e5" />

  <!-- External libraries (same as before) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.autotable.min.js" onload="window.pdfLibrariesLoaded = true;"></script>

  <link href="https://api.fonts.coollabs.io/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  {cssHref && <link rel="stylesheet" href={cssHref} />}
</head>
<body class="bg-slate-100 text-slate-800">
  <!-- Main Application Container -->
  <div id="app" class="container mx-auto p-4 md:p-6 max-w-7xl">
    <!-- Header component (keeps id on logo for client script compatibility) -->
    <Header />

    <!-- Loading State -->
    <div id="loading" class="flex flex-col justify-center items-center py-20">
      <div class="loader ease-linear rounded-full border-8 border-t-8 border-gray-200 h-24 w-24"></div>
      <p id="loading-message" class="mt-4 text-slate-600 text-center">Connecting to database...</p>
    </div>

    <!-- Main Content (Hidden until loaded) -->
    <main id="mainContent" class="hidden">
      <!-- Meets / Events / Results sections rendered via components -->
      <MeetsView />
      <EventsView />
      <ResultsView />
    </main>

    <!-- Public Sign-up View -->
    <SignupView />

    <!-- All dialogs / modals -->
    <Modals />
  </div>

  <!-- Client application script (extracted from inline into a module) -->
  <!-- This file should contain the previous large inline script logic but refactored as an ES
 module. -->
  <script type="module" src="/src/scripts/app.js"></script>
</body>
</html>
